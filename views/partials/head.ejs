<%
// I provide safe defaults and allow each view to override metadata via res.render(...).
const SITE_NAME = "Servicio de Transporte";
const APP_NAME = "TransportApp";
const BASE_URL = "https://serviciodetransportevic.com";

const pageTitle = (typeof title !== "undefined" && title) ? String(title) : "Servicio de Transporte | Victoria ↔ Llera";
const metaDesc = (typeof description !== "undefined" && description) ? String(description)
        : "Horarios, reservas y ubicación de salidas. Servicio diario de pasaje y paquetería.";

const canonical = (typeof canonicalUrl !== "undefined" && canonicalUrl) ? String(canonicalUrl) : `${BASE_URL}/`;

const ogTitle = (typeof og_title !== "undefined" && og_title) ? String(og_title) : pageTitle;
const ogDesc = (typeof og_description !== "undefined" && og_description) ? String(og_description) : metaDesc;
const ogUrl = (typeof og_url !== "undefined" && og_url) ? String(og_url) : canonical;
const ogImage = (typeof og_image !== "undefined" && og_image) ? String(og_image) : `${BASE_URL}/assets/og-transportapp.png`;

const twitterTitle = (typeof twitter_title !== "undefined" && twitter_title) ? String(twitter_title) : ogTitle;
const twitterDesc = (typeof twitter_description !== "undefined" && twitter_description) ? String(twitter_description) : ogDesc;
const twitterImage = (typeof twitter_image !== "undefined" && twitter_image) ? String(twitter_image) : ogImage;

// I let views set noindex=true for admin/ticket/print pages.
const isNoindex = (typeof noindex !== "undefined" && noindex);
const robots = isNoindex ? "noindex, nofollow" : "index, follow";
%>

<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>

<title><%= pageTitle %></title>

<!-- Primary meta -->
<meta name="application-name" content="<%= APP_NAME %>"/>
<meta name="description" content="<%= metaDesc %>"/>
<meta name="robots" content="<%= robots %>"/>
<meta name="referrer" content="strict-origin-when-cross-origin"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="color-scheme" content="light dark"/>
<meta name="theme-color" content="#6a0f1f"/>

<!-- Performance hints -->
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin/>
<link rel="dns-prefetch" href="//cdn.jsdelivr.net"/>

<!-- CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/theme.css" rel="stylesheet">

<!-- Canonical (skip for noindex pages) -->
<% if (!isNoindex) { %>
    <link rel="canonical" href="<%= canonical %>"/>
<% } %>

<!-- Favicons / PWA -->
<link rel="icon" href="/assets/favicon.ico"/>
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16.png"/>
<link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="192x192" href="/assets/android-chrome-192.png"/>
<link rel="icon" type="image/png" sizes="512x512" href="/assets/android-chrome-512.png"/>

<link rel="manifest" href="/assets/site.webmanifest"/>

<!-- Windows tiles (optional) -->
<meta name="msapplication-TileColor" content="#6a0f1f"/>
<meta name="msapplication-config" content="/assets/browserconfig.xml"/>

<!-- Open Graph -->
<meta property="og:locale" content="es_MX"/>
<meta property="og:type" content="website"/>
<meta property="og:site_name" content="<%= SITE_NAME %>"/>

<meta property="og:title" content="<%= ogTitle %>"/>
<meta property="og:description" content="<%= ogDesc %>"/>
<meta property="og:url" content="<%= ogUrl %>"/>

<meta property="og:image" content="<%= ogImage %>"/>
<meta property="og:image:secure_url" content="<%= ogImage %>"/>
<meta property="og:image:width" content="1200"/>
<meta property="og:image:height" content="630"/>
<meta property="og:image:alt" content="Servicio de Transporte Victoria ↔ Llera"/>

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="<%= twitterTitle %>"/>
<meta name="twitter:description" content="<%= twitterDesc %>"/>
<meta name="twitter:image" content="<%= twitterImage %>"/>
<meta name="twitter:image:alt" content="Servicio de Transporte Victoria ↔ Llera"/>
